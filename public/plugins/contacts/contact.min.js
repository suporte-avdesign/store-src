jQuery(function(t){if(t("#subject-contact").select2({placeholder:avd_config_contact.placeholder_subject}),"undefined"==typeof avd_config_contact)return!1;t.blockUI.defaults.overlayCSS.cursor="default";var e={updateTimer:!1,dirtyInput:!1,xhr:!1,$contact_form:t("form.contact"),init:function(){t(document.body).bind("update_contact",this.update_contact),t(document.body).bind("init_contact",this.init_contact),this.$contact_form.attr("novalidate","novalidate"),this.$contact_form.on("submit",this.submit),this.$contact_form.on("input validate change",".input-text, select, input:checkbox",this.validate_field),this.$contact_form.on("update",this.trigger_update_contact),"1"===avd_config_contact.is_contact&&t(document.body).trigger("init_contact")},init_contact:function(){t(document.body).trigger("update_contact")},maybe_input_changed:function(t){e.dirtyInput&&e.input_changed(t)},input_changed:function(t){e.dirtyInput=t.target},queue_update_contact:function(t){if(9===(t.keyCode||t.which||0))return!0;e.dirtyInput=this,e.reset_update_contact_timer()},trigger_update_contact:function(){e.reset_update_contact_timer(),e.dirtyInput=!1,t(document.body).trigger("update_contact")},reset_update_contact_timer:function(){clearTimeout(e.updateTimer)},is_valid_json:function(e){try{var o=t.parseJSON(e);return o&&"object"==typeof o}catch(t){return!1}},validate_field:function(e){var o=t(this),c=o.closest(".form-row"),r=!0,a=c.is(".validate-required"),i=c.is(".validate-email"),n=e.type;if("input"===n&&c.removeClass("woocommerce-invalid woocommerce-invalid-required-field woocommerce-invalid-email woocommerce-validated"),"validate"===n||"change"===n){if(a&&("checkbox"!==o.attr("type")||o.is(":checked")?""===o.val()&&(c.removeClass("woocommerce-validated").addClass("woocommerce-invalid woocommerce-invalid-required-field"),r=!1):(c.removeClass("woocommerce-validated").addClass("woocommerce-invalid woocommerce-invalid-required-field"),r=!1)),i)if(o.val())new RegExp(/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i).test(o.val())||(c.removeClass("woocommerce-validated").addClass("woocommerce-invalid woocommerce-invalid-email"),r=!1);r&&c.removeClass("woocommerce-invalid woocommerce-invalid-required-field woocommerce-invalid-email").addClass("woocommerce-validated")}},update_contact:function(t,o){e.reset_update_contact_timer(),e.updateTimer=setTimeout(e.update_contact_action,"5",o)},update_contact_action:function(o){if(e.xhr&&e.xhr.abort(),0!==t("form.contact").length)t("form.contact").serialize()},submit:function(){e.reset_update_contact_timer();var o=t(this);if(o.is(".processing"))return!1;!1!==o.triggerHandler("checkout_place_order")&&(o.addClass("processing"),1!==o.data()["blockUI.isBlocked"]&&o.block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),t.ajaxSetup({dataFilter:function(t,o){if("json"!==o)return t;if(e.is_valid_json(t))return t;var c=t.match(/{"result.*}/);return null===c?console.log("Unable to fix malformed JSON"):e.is_valid_json(c[0])?(console.log("Fixed malformed JSON. Original:"),console.log(t),t=c[0]):console.log("Unable to fix malformed JSON"),t}}),t.ajax({type:"POST",url:avd_config_contact.contact_url,data:o.serialize(),dataType:"json",beforeSend:function(){console.log(this.data)},success:function(o){try{if("success"===o.result)e.$contact_form.html('<div class="return-contact">'+o.success+"</div>"),e.scroll_to_notices();else if("redirect"===o.result)-1===o.redirect.indexOf("https://")||-1===o.redirect.indexOf("http://")?window.location=o.redirect:window.location=decodeURI(o.redirect);else{if("failure"!==o.result)throw avd_config_contact.error_json;e.submit_error(o.message)}}catch(c){if(!0===o.reload)return void window.location.reload();!0===o.refresh&&t(document.body).trigger("update_contact"),o.message?e.submit_error(o.message):e.submit_error('<div class="woocommerce-error">'+avd_config_contact.i18n_contact_error+"</div>")}},error:function(o){if(422==o.status){var c=t.parseJSON(o.responseText),r="";t.each(c,function(e,o){"errors"==e&&t.each(c[e],function(t,e){r+="<li>"+e+"</li>"})})}e.submit_error('<ul class="woocommerce-error">'+r+"</ul>"),setTimeout(function(){t(".return-contact").hide()},8e3)}}));return!1},submit_error:function(o){t(".return-contact, .woocommerce-error, .woocommerce-message").remove(),e.$contact_form.prepend('<div class="return-contact">'+o+"</div>"),e.$contact_form.removeClass("processing").unblock(),e.$contact_form.find(".input-text, select, input:checkbox").trigger("validate").blur(),e.scroll_to_notices(),t(document.body).trigger("contact_error")},return_success:function(o){alert("pegou"),t(".return-contact, .woocommerce-error, .woocommerce-message").remove(),e.$contact_form.html('<div class="return-contact">'+o+"</div>")},scroll_to_notices:function(){var e=t(".return-contact");e.length||(e=t(".form.contact")),t.scroll_to_notices(e)}};e.init()});
